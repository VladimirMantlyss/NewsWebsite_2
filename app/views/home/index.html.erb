<h1>Новини</h1>

<div id="News">
  <div class="list-group">
    <% @posts.each do |post| %>
      <div class="list-group-item">
        <h3 class="mb-1"><%= post.title %></h3>
        <br>
        <p class="mb-1"><%= post.post_text %></p>
        <h6 class="mb-1">Тип: <%= post.post_type.type %></h6>
        <h6 class="mb-1">Автор: <%= post.authors.first&.user&.name %></h6>


        <small><%= post.created_at %></small>
        <div class="mt-2">
          <% if current_user %>
<!--            <p>Идентификатор текущего пользователя: <%#= current_user.id %></p>-->
            <% if Author.exists?(user_id: current_user.id) %>
              <% author = Author.find_by(user_id: current_user.id) %>
<!--              <p>Имя пользователя: <%#= author.user.name %></p>-->
              <%= link_to "Редагувати", edit_post_path(post), class: "btn btn-secondary mr-2" %>
            <% else %>
              <%= form_with(model: [post, Commentar.new]) do |form| %>
                <%= form.hidden_field :post_id, value: post.id %>
                <%= form.text_area :commentar_text, class: "form-control", placeholder: "Введите комментарий" %>

                <%= form.submit "Добавить комментарий", class: "btn btn-primary mt-2" %>
              <% end %>


        <% end %>
          <% else %>
            <p>Пожалуйста, войдите в систему для выполнения действий.</p>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
